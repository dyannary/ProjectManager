<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

<table id="UserDatabase" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0">
    <thead class="table-dark">
    </thead>
    <tbody>
    </tbody>
</table>

@section scripts {
    <script>
        $(document).ready(function () {
            initializeUserDataTable();
        });

        function initializeUserDataTable() {
            var table = $('#UserDatabase').DataTable({

                "serverSide": true,
                "dom": "<'row'<'col-sm-12'f><'col-sm-12'tr>><'row'<'col-sm-5'i><'col-sm-7'p>>", // Includes search input box ("f") //f, r, t, l, p
                "pageLength": 15,
                ajax: {
                    "url": "/Admin/UserTable",
                    "type": "POST",
                    "dataType": "json",
                },
                "columns": [
                    { "data": "Id", "title": "Id", "name": "Id", "visible": false },
                    { "data": "RoleId", "title": "RoleId", "name": "RoleId", "visible": false },
                    { "data": "UserName", "title": "UserName", "name": "UserName", "autoWidth": true },
                    { "data": "FirstName", "title": "FirstName", "name": "FirstName", "autoWidth": true },
                    { "data": "LastName", "title": "LastName", "name": "LastName", "autoWidth": true },
                    { "data": "Email", "title": "Email", "name": "Email", "autoWidth": true },
                    {
                        "data": "CreatedDate",
                        "title": "CreatedDate",
                        "name": "CreatedDate",
                        "autoWidth": true,
                        "render": function (data, type, row) {
                            if (type === 'display') {
                                var date = new Date(parseInt(data.substr(6)));
                                var day = date.getDate();
                                var month = date.getMonth() + 1;
                                var year = date.getFullYear();
                                return (day < 10 ? '0' : '') + day + '/' + (month < 10 ? '0' : '') + month + '/' + year;
                            }
                            return data;
                        }
                    },
                    {
                        "data": "IsEnabled",
                        "title": "IsEnabled",
                        "name": "IsEnabled",
                        "autoWidth": true,
                        "render": function (data, type) {
                            if (type === 'display') {
                                if (data === true || data === 'true') {
                                    return '<i class="fas fa-check-circle text-success"></i>';
                                } else {
                                    return '<i class="fas fa-times-circle text-danger"></i>';
                                }
                            }
                            return data;
                        }
                    },

                    {
                        "data": "Actions",
                        "title": "Actions",
                        "dataSorter": false,
                        "orderable": false,
                        "render": function (data, type, full, meta) {
                            var idUser = full.Id;

                            return `<button class="btn id="modalConfirmButton" onclick="openModal({url: '/Admin/UpdateUser', data: ${idUser}})" data-toggle="ajax-modal" data-trigger="Modal">Edit</button>`;
                        }
                    }

                    //Paginarea nu lucreaza daca ignor coloana
                    //Nu lucreaza filtrarea daca las ultima coloana

                     //Disable button
                    //{
                    //    "title": "Actions",
                    //    "dataSorter": false,
                    //    "orderable": false,
                    //    "render": function (data, type, full, meta) {
                    //        var idUser = full.Id;
                    //        var isEnabled = full.IsEnabled;
                    //        var buttonText = isEnabled ? "Disable" : "Enable";
                    //        var buttonClass = isEnabled ? "btn-outline-danger" : "btn-outline-success";
                    //        return `<button class="btn ${buttonClass}" id="modalConfirmButton" onclick="openModal({url: '/Admin/OpenDisableUserModal', data: ${idUser}})" data-toggle="ajax-modal" data-trigger="Modal">${buttonText}</button>`;
                    //    }
                    //}
                ],
                "pagingType": "full_numbers", // Use full_numbers for your pagination style
                "language": {
                    "paginate": {
                        "first": "First",
                        "previous": "&laquo;",
                        "next": "&raquo;",
                        "last": "Last"
                    }
                }
            });

            return table;
        }
    </script>
}