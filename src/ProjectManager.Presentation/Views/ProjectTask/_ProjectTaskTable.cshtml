@using ProjectManager.Application.DataTransferObjects.ProjectTask;
@model List<ProjectTaskById>


<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css" rel="stylesheet">


<div class="text">
    <button type="button" class="btn btn-danger" onclick="openModal({url: '/ProjectTask/AddTask', data: 0})" data-bs-toggle="modal" data-bs-target="#addTaskModal">+</button>
</div>


<table id="ProjecTasksTable" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0">
    <thead class="table-dark">
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>Assigned To</th>
            <th>Task State</th>
            <th>Created Date</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

@section scripts {
    <script>
        debugger;
        $(document).ready(function () {
            initializeUserDataTable();
        });

        function initializeUserDataTable() {
            debugger;
            var table = $('#ProjecTasksTable').DataTable({

                "serverSide": true,
                "dom": "<'row-4'<'col-sm-2'><'col-sm-12'f><'col-sm-12'tr>><'row'<'col-sm-5'i><'col-sm-7'p>>", // Includes search input box ("f") //f, r, t, l, p
                "pageLength": 15,
                "order": [[6, 'desc']],
                ajax: {
                    "url": "/ProjectTask/TasksTable",
                    "type": "POST",
                    "dataType": "json",
                },
                "columns": [
                    { "data": "Id", "title": "Id", "name": "Id", "visible": false },
                    { "data": "Name", "title": "Name", "name": "Name", "visible": false },
                    { "data": "AssignedTo", "title": "AssignedTo", "name": "AssignedTo", "autoWidth": true },
                    { "data": "TaskState", "title": "TaskState", "name": "TaskState", "autoWidth": true },
                    {
                        "data": "CreatedDate",
                        "title": "CreatedDate",
                        "name": "CreatedDate",
                        "autoWidth": true,
                        "render": function (data, type, row) {
                            if (type === 'display') {
                                var date = new Date(parseInt(data.substr(6)));
                                var day = date.getDate();
                                var month = date.getMonth() + 1;
                                var year = date.getFullYear();
                                return (day < 10 ? '0' : '') + day + '/' + (month < 10 ? '0' : '') + month + '/' + year;
                            }
                            return data;
                        }
                    },
                ],
                "pagingType": "full_numbers",
                "language": {
                    "paginate": {
                        "first": "First",
                        "previous": "&laquo;",
                        "next": "&raquo;",
                        "last": "Last"
                    }
                }
            });

            return table;
        }
    </script>
}

